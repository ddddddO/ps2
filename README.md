# ğŸ® PS2

[![GitHub release](https://img.shields.io/github/release/ddddddO/ps2.svg?label=Release&color=darkcyan)](https://github.com/ddddddO/ps2/releases)
[![codecov](https://codecov.io/gh/ddddddO/ps2/graph/badge.svg?token=6E0G81K2H0)](https://codecov.io/gh/ddddddO/ps2)
[![ci](https://github.com/ddddddO/ps2/actions/workflows/ci.yaml/badge.svg)](https://github.com/ddddddO/ps2/actions/workflows/ci.yaml)


**phP Serialize() To xxxx (e.g. JSON)**

Web and CLI tool are available!</br>

> [!WARNING]
> Use it for easy human checking.

Converts data serialized by the PHP serialize function into some format (only JSON for now).</br>
This may be useful if you want to convert the payload string stored in the Laravel job queue ğŸ‘ </br>
If you find a bug or have a request, please create issue or Pull Request!

Web ğŸ‘‰ https://ddddddo.github.io/ps2/ </br>
Conversion can be done offline as it is processed in Wasm.

## Supported Types
|-|Type|Note|
|--|--|--|
|â­•|`a:5;`||
|â­•|`s:4:"xxxx";`||
|â­•|`E:4:"xxxx";`||
|â­•|`i:555`||
|â­•|`d:3.14`||
|â­•|`b:0` / `b:1`||
|â­•|`N`||
|â­•|`r:1` / `R:1`| filled with `[[PHP_REFERENCE_DATA: <actual referenced unserialized data>]]` |
|â­•|`O:3:"Obj":2:{...}`||
|â­•|`C:3:"Csm":2:{...}`||

## Install

### Homebrew

```console
brew install ddddddO/tap/ps2
```

### Go
```console
go install github.com/ddddddO/ps2/cmd/ps2@latest
```

## Usage

- â€» `echo 'O:13:"App\UpdateJob....' | ps2` ã¿ãŸã„ã« echo ã§ã‚„ã‚‹ã¨ã€`\U`ãŒå‰Šã‚‰ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€`<<<` ã‹ `printf` æ¨å¥¨

Format:
```console
$ ps2 <<< '< Data serialized by PHP serialize function >'
```

Example:

```console
$ ps2 <<< 'O:13:"MySimpleClass":17:{s:10:"publicProp";s:16:"Top Level Object";s:26:"MySimpleClassprivateProp";i:999;s:16:"*protectedProp";a:3:{s:10:"assoc_key1";s:12:"assoc_value1";s:10:"assoc_key2";i:789;s:17:"deep_nested_array";a:2:{s:9:"sub_key_x";s:11:"sub_value_x";s:9:"sub_key_y";d:12.34;}}s:6:"parent";N;s:15:"nestedArrayData";a:5:{i:0;s:6:"Item A";i:1;s:6:"Item B";i:2;s:6:"Item C";i:3;i:10;i:4;b:0;}s:16:"sharedStringRef1";s:33:"å…±æœ‰ã•ã‚Œã‚‹æ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿";s:16:"sharedStringRef2";s:33:"å…±æœ‰ã•ã‚Œã‚‹æ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿";s:16:"sharedObjectRef1";O:13:"MySimpleClass":6:{s:10:"publicProp";s:24:"å…±é€šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ";s:26:"MySimpleClassprivateProp";i:500;s:16:"*protectedProp";a:1:{s:6:"shared";b:1;}s:6:"parent";N;s:15:"nestedArrayData";a:0:{}s:9:"nullValue";N;}s:16:"sharedObjectRef2";r:19;s:21:"customSerializableObj";O:20:"MyCustomSerializable":2:{s:1:"s";s:36:"ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ã‚«ã‚¹ã‚¿ãƒ ";s:1:"n";i:777;}s:12:"userRoleEnum";E:15:"UserRole:Editor";s:10:"statusEnum";E:13:"Status:Active";s:9:"nullValue";N;s:11:"booleanTrue";b:1;s:10:"floatValue";d:45.67;s:12:"integerValue";i:123;s:14:"japaneseString";s:36:"ã“ã‚Œã¯æ—¥æœ¬èªã®æ–‡å­—åˆ—ã§ã™";'
{
  "*protectedProp": {
    "assoc_key1": "assoc_value1",
    "assoc_key2": 789,
    "deep_nested_array": {
      "sub_key_x": "sub_value_x",
      "sub_key_y": 12.34
    }
  },
  "MySimpleClassprivateProp": 999,
  "__class_name": "MySimpleClass",
  "booleanTrue": true,
  "customSerializableObj": {
    "__class_name": "MyCustomSerializable",
    "n": 777,
    "s": "ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ã‚«ã‚¹ã‚¿ãƒ "
  },
  "floatValue": 45.67,
  "integerValue": 123,
  "japaneseString": "ã“ã‚Œã¯æ—¥æœ¬èªã®æ–‡å­—åˆ—ã§ã™",
  "nestedArrayData": [
    "Item A",
    "Item B",
    "Item C",
    10,
    false
  ],
  "nullValue": null,
  "parent": null,
  "publicProp": "Top Level Object",
  "sharedObjectRef1": {
    "*protectedProp": {
      "shared": true
    },
    "MySimpleClassprivateProp": 500,
    "__class_name": "MySimpleClass",
    "nestedArrayData": [],
    "nullValue": null,
    "parent": null,
    "publicProp": "å…±é€šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ"
  },
  "sharedObjectRef2": "[[PHP_REFERENCE_DATA: map[*protectedProp:map[shared:true] MySimpleClassprivateProp:500 __class_name:MySimpleClass nestedArrayData:map[] nullValue:\u003cnil\u003e parent:\u003cnil\u003e publicProp:å…±é€šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ]]]",
  "sharedStringRef1": "å…±æœ‰ã•ã‚Œã‚‹æ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿",
  "sharedStringRef2": "å…±æœ‰ã•ã‚Œã‚‹æ–‡å­—åˆ—ãƒ‡ãƒ¼ã‚¿",
  "statusEnum": "Status:Active",
  "userRoleEnum": "UserRole:Editor"
}
$
```

## Related tool
- **[PHP Serialized Object viewer](https://github.com/haradakunihiko/intellij-plugin-php-serialized-object-viewer)**
    - If you are using IntelliJ IDEA / PhpStorm, please try this plugin!

## Memo

- The first version of this tool was generated by `Gemini 2.5 Flash`.
    ```
    phpã®serializeé–¢æ•°ã§ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã•ã‚ŒãŸæ–‡å­—åˆ—ï¼ˆå…ƒã®ãƒ‡ãƒ¼ã‚¿ã¯ã€ãƒã‚¹ãƒˆã—ãŸé€£æƒ³é…åˆ—ã¨ã€é…åˆ—ã¨ã€é©å½“ãªã‚¯ãƒ©ã‚¹ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æŒã¤ï¼‰ã‹ã‚‰ã€astã‚’ç”Ÿæˆã™ã‚‹goãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚
    ```

    - ä¸€ç™ºã§å‹•ã‹ãªã„ & å¾®èª¿æ•´ã®å¿…è¦ãŒã‚ã£ãŸãŸã‚æ‰‹ã‚’å…¥ã‚Œã¦ã„ã‚‹
    - ç”Ÿæˆã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã¯ã€ŒGoè¨€èªã§ã¤ãã‚‹ã‚¤ãƒ³ã‚¿ãƒ—ãƒªã‚¿ã€ã®å†…å®¹ã«ã‹ãªã‚Šä¼¼ã¦ã„ã‚‹

- PHP serialize()
    - https://www.php.net/manual/ja/function.serialize.php

- This tool has been verified to work with serialized data generated by PHP 7.4.33.

- [Reddit: r/PHP](https://www.reddit.com/r/PHP/comments/1l61qw7/github_ddddddops2_tool_to_convert_from_serialized/?utm_source=share&utm_medium=web3x&utm_name=web3xcss&utm_term=1&utm_content=share_button)